20231110 18:14:22 - 1776817 [INFO] using gpss default config
20231110 18:14:22 - 1776817 [INFO] config file content:
{"ListenAddress":{"Host":"","Port":5000,"DebugPort":0,"Certificate":null},"Gpfdist":{"Host":"rmq.c.pde-fsidi.internal","Port":8080,"ReuseTables":true,"Certificate":null,"BindAddress":"0.0.0.0"},"logging":{}}
20231110 18:14:22 - 1776817 [INFO] gpss-listen-address-prefix: :5000
20231110 18:14:22 - 1776817 [INFO] Please set 'JobStore' in the config if you want to save job status.
20231110 18:14:22 - 1776817 [INFO] gpss version: 1.10.3
20231110 18:14:22 - 1776817 [INFO] librdkafka version: 1.4.2(10402ff)
20231110 18:14:22 - 1776817 [FATAL] gpfdist start failed: listen fail: listen tcp 0.0.0.0:8080: bind: address already in use
20231110 18:17:43 - 1781520 [INFO] using config file: gpss.json
20231110 18:17:43 - 1781520 [INFO] config file content:
{"ListenAddress":{"Host":"","Port":8082,"DebugPort":0,"Certificate":null},"Gpfdist":{"Host":"rmq.c.pde-fsidi.internal","Port":8081,"ReuseTables":false,"Certificate":null,"BindAddress":"0.0.0.0"},"logging":{}}
20231110 18:17:43 - 1781520 [INFO] gpss-listen-address-prefix: :8082
20231110 18:17:43 - 1781520 [INFO] Please set 'JobStore' in the config if you want to save job status.
20231110 18:17:43 - 1781520 [INFO] gpss version: 1.10.3
20231110 18:17:43 - 1781520 [INFO] librdkafka version: 1.4.2(10402ff)
20231110 18:17:43 - 1781520 [INFO] gpss will use random external table name, external table won't be get reused
20231110 18:17:43 - 1781520 [INFO] gpfdist listening on 0.0.0.0:8081
20231110 18:17:43 - 1781520 [INFO] start timeout session cleaner...
20231110 18:17:43 - 1781520 [INFO] 'JobStore' is empty. No job will be resumed.
20231110 18:17:43 - 1781520 [INFO] Finished resuming jobs.
20231110 18:17:43 - 1781520 [INFO] gpss listening on :8082
20231110 18:25:20 - 1781520 [ERROR] RPC method /api.Public/SubmitJob failed: SubmitJob failed: OmniParseToJobConfig failed: parseContentByConfigV1AndV2 failed, content:
 DATABASE: warehouse
USER: gpadmin
HOST: localhost
PORT: 5432
VERSION: 2

RABBITMQ:
  INPUT:
    SOURCE:
      SERVER: guest:guest@localhost:5672
      QUEUE: rooms
      VIRTUALHOST: /
    DATA:
      COLUMNS:
        - NAME: j
          TYPE: json
      FORMAT: json
    ERROR_LIMIT: 25

OUTPUT:
  TABLE: rooms
  MODE: MERGE
  MATCH_COLUMNS:
    - id
  DELETE_CONDITION: ((j->>'payload')::json->>'op') = 'd'
  MAPPING:
    - NAME: id
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'id')::int ELSE (((j->>'payload')::json->>'after')::json->>'id')::int END
    - NAME: name
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'name')::text ELSE (((j->>'payload')::json->>'after')::json->>'name')::text END
    - NAME: hotel_id
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'hotel_id')::text ELSE (((j->>'payload')::json->>'after')::json->>'hotel_id')::text END
    - NAME: description
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'description')::text ELSE (((j->>'payload')::json->>'after')::json->>'description')::text END
    - NAME: total_rooms
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'total_rooms')::int ELSE (((j->>'payload')::json->>'after')::json->>'total_rooms')::int END
    - NAME: used_rooms
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'used_rooms')::int ELSE (((j->>'payload')::json->>'after')::json->>'used_rooms')::int END
    - NAME: left_rooms
      EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'left_rooms')::int ELSE (((j->>'payload')::json->>'after')::json->>'left_rooms')::int END


: ParseConfigContent failed: yaml: unmarshal errors:
  line 20: field OUTPUT not found in type rabbitmqconfig.ConfigV2
20231110 18:26:45 - 1781520 [INFO] consistency not specified,use at-least as default
20231110 18:26:45 - 1781520 [INFO] submit successfully, job name gpss_job
20231110 18:26:50 - 1781520 [INFO] consistency not specified,use at-least as default
20231110 18:27:00 5882fddb 1781520 [INFO] start job, id:5882fddb5d6d55b80e98de4013d56753, name:gpss_job
20231110 18:27:00 5882fddb 1781520 [INFO] initialize dummy history store for consistency: at-least
20231110 18:27:00 5882fddb 1781520 [ERROR] job finished, id: 5882fddb5d6d55b80e98de4013d56753, name: gpss_job, status: JobStatusError, message: Exception (406) Reason: "PRECONDITION_FAILED - consumer prefetch count is not set for 'queue 'rooms' in vhost '/''"
20231110 18:27:00 5882fddb 1781520 [ERROR] err exec job prepare, Exception (406) Reason: "PRECONDITION_FAILED - consumer prefetch count is not set for 'queue 'rooms' in vhost '/''"
job failed to prepare
github.com/pivotal/gp-stream-server/utils/util.ErrWrap
	/home/gpadmin/gpss_src/utils/util/util.go:34
github.com/pivotal/gp-stream-server/server/loader/common.(*BatchedJob).Prepare.func1
	/home/gpadmin/gpss_src/server/loader/common/job.go:151
github.com/pivotal/gp-stream-server/server/loader/common.(*BatchedJob).Prepare
	/home/gpadmin/gpss_src/server/loader/common/job.go:217
github.com/pivotal/gp-stream-server/manager.(*Manager).prepare
	/home/gpadmin/gpss_src/manager/manager.go:522
github.com/pivotal/gp-stream-server/manager.(*Manager).startByDesc
	/home/gpadmin/gpss_src/manager/manager.go:277
github.com/pivotal/gp-stream-server/manager.(*Manager).start
	/home/gpadmin/gpss_src/manager/manager.go:273
github.com/pivotal/gp-stream-server/manager.(*Manager).Start
	/home/gpadmin/gpss_src/manager/manager.go:260
github.com/pivotal/gp-stream-server/server/controller.(*JobServer).StartJob
	/home/gpadmin/gpss_src/server/controller/job_server.go:163
github.com/pivotal/gp-stream-server/server/api/proto/go._Public_StartJob_Handler.func1
	/home/gpadmin/gpss_src/server/api/proto/go/public.pb.go:1336
github.com/pivotal/gp-stream-server/server/controller.grpcInterceptor
	/home/gpadmin/gpss_src/server/controller/server.go:159
github.com/pivotal/gp-stream-server/server/api/proto/go._Public_StartJob_Handler
	/home/gpadmin/gpss_src/server/api/proto/go/public.pb.go:1338
google.golang.org/grpc.(*Server).processUnaryRPC
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:1336
google.golang.org/grpc.(*Server).handleStream
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:1704
google.golang.org/grpc.(*Server).serveStreams.func1.2
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:965
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1594
20231110 18:27:00 - 1781520 [WARNING] retry job gpss_job is disabled, stop schedule
20231110 18:27:57 5882fddb 1781520 [INFO] start job, id:5882fddb5d6d55b80e98de4013d56753, name:gpss_job
20231110 18:27:57 5882fddb 1781520 [INFO] initialize dummy history store for consistency: at-least
20231110 18:27:57 5882fddb 1781520 [ERROR] job finished, id: 5882fddb5d6d55b80e98de4013d56753, name: gpss_job, status: JobStatusError, message: Exception (406) Reason: "PRECONDITION_FAILED - consumer prefetch count is not set for 'queue 'rooms' in vhost '/''"
20231110 18:27:57 5882fddb 1781520 [ERROR] err exec job prepare, Exception (406) Reason: "PRECONDITION_FAILED - consumer prefetch count is not set for 'queue 'rooms' in vhost '/''"
job failed to prepare
github.com/pivotal/gp-stream-server/utils/util.ErrWrap
	/home/gpadmin/gpss_src/utils/util/util.go:34
github.com/pivotal/gp-stream-server/server/loader/common.(*BatchedJob).Prepare.func1
	/home/gpadmin/gpss_src/server/loader/common/job.go:151
github.com/pivotal/gp-stream-server/server/loader/common.(*BatchedJob).Prepare
	/home/gpadmin/gpss_src/server/loader/common/job.go:217
github.com/pivotal/gp-stream-server/manager.(*Manager).prepare
	/home/gpadmin/gpss_src/manager/manager.go:522
github.com/pivotal/gp-stream-server/manager.(*Manager).startByDesc
	/home/gpadmin/gpss_src/manager/manager.go:277
github.com/pivotal/gp-stream-server/manager.(*Manager).start
	/home/gpadmin/gpss_src/manager/manager.go:273
github.com/pivotal/gp-stream-server/manager.(*Manager).Start
	/home/gpadmin/gpss_src/manager/manager.go:260
github.com/pivotal/gp-stream-server/server/controller.(*JobServer).StartJob
	/home/gpadmin/gpss_src/server/controller/job_server.go:163
github.com/pivotal/gp-stream-server/server/api/proto/go._Public_StartJob_Handler.func1
	/home/gpadmin/gpss_src/server/api/proto/go/public.pb.go:1336
github.com/pivotal/gp-stream-server/server/controller.grpcInterceptor
	/home/gpadmin/gpss_src/server/controller/server.go:159
github.com/pivotal/gp-stream-server/server/api/proto/go._Public_StartJob_Handler
	/home/gpadmin/gpss_src/server/api/proto/go/public.pb.go:1338
google.golang.org/grpc.(*Server).processUnaryRPC
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:1336
google.golang.org/grpc.(*Server).handleStream
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:1704
google.golang.org/grpc.(*Server).serveStreams.func1.2
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:965
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1594
20231110 18:27:57 - 1781520 [WARNING] retry job gpss_job is disabled, stop schedule
20231110 18:28:00 - 1781520 [INFO] consistency not specified,use at-least as default
20231110 18:28:00 - 1781520 [INFO] submit successfully, job name gpss_job
20231110 18:28:00 - 1781520 [WARNING] retry job gpss_job has been replaced, stop old schedule
20231110 18:28:01 5882fddb 1781520 [INFO] start job, id:5882fddb5d6d55b80e98de4013d56753, name:gpss_job
20231110 18:28:01 5882fddb 1781520 [INFO] initialize dummy history store for consistency: at-least
20231110 18:28:01 5882fddb 1781520 [ERROR] job finished, id: 5882fddb5d6d55b80e98de4013d56753, name: gpss_job, status: JobStatusError, message: Exception (406) Reason: "PRECONDITION_FAILED - consumer prefetch count is not set for 'queue 'rooms' in vhost '/''"
20231110 18:28:01 5882fddb 1781520 [ERROR] err exec job prepare, Exception (406) Reason: "PRECONDITION_FAILED - consumer prefetch count is not set for 'queue 'rooms' in vhost '/''"
job failed to prepare
github.com/pivotal/gp-stream-server/utils/util.ErrWrap
	/home/gpadmin/gpss_src/utils/util/util.go:34
github.com/pivotal/gp-stream-server/server/loader/common.(*BatchedJob).Prepare.func1
	/home/gpadmin/gpss_src/server/loader/common/job.go:151
github.com/pivotal/gp-stream-server/server/loader/common.(*BatchedJob).Prepare
	/home/gpadmin/gpss_src/server/loader/common/job.go:217
github.com/pivotal/gp-stream-server/manager.(*Manager).prepare
	/home/gpadmin/gpss_src/manager/manager.go:522
github.com/pivotal/gp-stream-server/manager.(*Manager).startByDesc
	/home/gpadmin/gpss_src/manager/manager.go:277
github.com/pivotal/gp-stream-server/manager.(*Manager).start
	/home/gpadmin/gpss_src/manager/manager.go:273
github.com/pivotal/gp-stream-server/manager.(*Manager).Start
	/home/gpadmin/gpss_src/manager/manager.go:260
github.com/pivotal/gp-stream-server/server/controller.(*JobServer).StartJob
	/home/gpadmin/gpss_src/server/controller/job_server.go:163
github.com/pivotal/gp-stream-server/server/api/proto/go._Public_StartJob_Handler.func1
	/home/gpadmin/gpss_src/server/api/proto/go/public.pb.go:1336
github.com/pivotal/gp-stream-server/server/controller.grpcInterceptor
	/home/gpadmin/gpss_src/server/controller/server.go:159
github.com/pivotal/gp-stream-server/server/api/proto/go._Public_StartJob_Handler
	/home/gpadmin/gpss_src/server/api/proto/go/public.pb.go:1338
google.golang.org/grpc.(*Server).processUnaryRPC
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:1336
google.golang.org/grpc.(*Server).handleStream
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:1704
google.golang.org/grpc.(*Server).serveStreams.func1.2
	/home/gpadmin/go/pkg/mod/google.golang.org/grpc@v1.53.0/server.go:965
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1594
20231110 18:28:01 - 1781520 [WARNING] retry job gpss_job is disabled, stop schedule
20231110 19:06:36 - 1781520 [ERROR] RPC method /api.Public/SubmitJob failed: SubmitJob failed: OmniParseToJobConfig failed: parseContentByConfigV1AndV2 failed, content:
 DATABASE: warehouse
USER: gpadmin
HOST: localhost
PORT: 5432
VERSION: 2

RABBITMQ:
  INPUT:
    SOURCE:
      SERVER: guest:guest@localhost:5672
      QUEUE: rooms
      VIRTUALHOST: /
    DATA:
      COLUMNS:
        - NAME: j
          TYPE: json
      FORMAT: json
    ERROR_LIMIT: 2500
  OUTPUT:
    TABLE: rooms
    MODE: MERGE
    MATCH_COLUMNS:
      - id
    DELETE_CONDITION: ((j->>'payload')::json->>'op') = 'd'
    MAPPING:
      - NAME: id
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'id')::int ELSE (((j->>'payload')::json->>'after')::json->>'id')::int END
      - NAME: name
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'name')::text ELSE (((j->>'payload')::json->>'after')::json->>'name')::text END
      - NAME: hotel_id
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'hotel_id')::text ELSE (((j->>'payload')::json->>'after')::json->>'hotel_id')::text END
      - NAME: description
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'description')::text ELSE (((j->>'payload')::json->>'after')::json->>'description')::text END
      - NAME: total_rooms
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'total_rooms')::int ELSE (((j->>'payload')::json->>'after')::json->>'total_rooms')::int END
      - NAME: used_rooms
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'used_rooms')::int ELSE (((j->>'payload')::json->>'after')::json->>'used_rooms')::int END
      - NAME: left_rooms
        EXPRESSION: CASE WHEN ((j->>'payload')::json->>'op') = 'd' THEN (((j->>'payload')::json->>'before')::json->>'left_rooms')::int ELSE (((j->>'payload')::json->>'after')::json->>'left_rooms')::int END
    PROPERTIES:
      eof.when.idle: 1500
      qos.prefetch.count: 10

: ParseConfigContent failed: yaml: unmarshal errors:
  line 40: field PROPERTIES not found in type shared.ConfigOutput
20231110 19:06:59 - 1781520 [INFO] consistency not specified,use at-least as default
20231110 19:06:59 - 1781520 [INFO] submit successfully, job name gpss_job
20231110 19:06:59 - 1781520 [WARNING] retry job gpss_job has been replaced, stop old schedule
20231110 19:07:01 5882fddb 1781520 [INFO] start job, id:5882fddb5d6d55b80e98de4013d56753, name:gpss_job
20231110 19:07:01 5882fddb 1781520 [INFO] initialize dummy history store for consistency: at-least
20231110 19:07:01 5882fddb 1781520 [INFO] transformer for job:gpss_job is nil, ignore it
